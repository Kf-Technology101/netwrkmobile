<ion-content has-main-btn has-main-btn-label>
  <div class="chat-container" #chatContainer>
    <div class="message" *ngFor="let message of lgMessages; let i = index"
         [@fadeState]="'fadeInVeryFast'">
      <img *ngIf="message.user"
        (click)="goToProfile(message.user_id, message.public)"
        [src]="message.public
          ? message.user.avatar_url
          : message.user.hero_avatar_url"
        class="chat-avatar">
      <img *ngIf="!message.user"
        (click)="goToProfile(message.user_id, message.public)"
        [src]="toolsPrvd.defaultAvatar"
        class="chat-avatar">
      <p class="message-container">
        <span class="username" *ngIf="message.user">
          <ng-container *ngIf="message.public">
            {{ message.user.name }}
          </ng-container>
          <ng-container *ngIf="!message.public">
            {{ message.user.role_name }}
          </ng-container>
        </span>
        <span class="message-date">{{ message.dateStr }}</span>
        <span *ngIf="message.social" class="shared-status">Shared via {{ message.social }}</span>
        <span *ngIf="message.isTemporary" class="visible-for">
          <ion-icon ios="ios-time-outline" md="ios-time-outline"></ion-icon>
          {{ message.temporaryFor }}
        </span>
        <span *ngIf="message.text" class="text"
              [ngClass]="{ 'emoji' : message.is_emoji }">{{ message.text }}</span>
      </p>
      <button class="feedback-button" (click)="openFeedbackModal(message, i)"
        *ngIf="!message.locked">
      </button>
      <button class="feedback-button lock"
        *ngIf="message.locked">
        <ion-icon ios="ios-lock" md="ios-lock"></ion-icon>
      </button>
      <img *ngFor="let j of message.image_urls" src="{{j}}"
            (load)="chatPrvd.calcLoadedImages()"/>
    </div>
  </div>
</ion-content>

<ion-footer>
  <button isScrolling="false" [hidden]="chatPrvd.mainBtn.hidden"
    [@mainBtnState]="chatPrvd.mainBtn.state" color="bk"
    class="main-action-btn big has-footer transparent chatMainBtn"
    (click)="closeModal()">
  </button>
</ion-footer>
